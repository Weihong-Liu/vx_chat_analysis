# 话题可视化查看器 - 使用说明

## 功能特性

✅ **完整的对话展示** - 查看话题中的每一条消息
✅ **美观的界面** - 现代化设计，支持响应式布局
✅ **即时搜索** - 快速过滤话题
✅ **统计信息** - 显示话题总数、消息数、参与者数量
✅ **一键导入** - 直接导入 JSON 文件即可查看

---

## 快速开始

### 1. 生成数据

首先运行管道生成话题数据：

```bash
python main.py
```

这会在 `output/topics.json` 中生成话题数据。

### 2. 打开查看器

在浏览器中打开：

```bash
open viewer/topic_viewer.html
```

或者直接双击 `viewer/topic_viewer.html` 文件。

### 3. 导入数据

点击 **"📁 导入 JSON 文件"** 按钮，选择 `output/topics.json`。

---

## 界面说明

### 顶部统计栏

导入数据后，顶部会显示：

- **话题总数** - 检测到的话题数量
- **总消息数** - 所有话题的消息总数
- **参与者** - 参与讨论的总人数

### 搜索框

输入关键词实时过滤话题：
- 按标题搜索
- 按摘要搜索
- 按参与者搜索

### 话题卡片

每个话题卡片显示：

```
┌────────────────────────────────────┐
│ 话题标题                    5条消息 │  ← 标题 + 消息数
│ 👤 张三  👥 3人  ⏰ 1月15日 14:30  │  ← 元信息
│                                    │
│ 摘要: 今天天气真好...              │  ← 话题摘要
└────────────────────────────────────┘
```

点击卡片打开完整对话。

### 对话详情模态框

点击话题后，会弹出详情窗口，显示：

1. **话题信息**
   - 标题
   - 发起人
   - 参与者列表
   - 开始时间

2. **话题摘要**（如果有）
   - AI 生成的核心结论

3. **完整消息列表**
   - 每条消息的发送者
   - 消息内容
   - 发送时间
   - 彩色头像

---

## 数据格式

`topics.json` 的格式：

```json
[
  {
    "topic_id": "abc123",
    "title": "关于周末聚会的讨论",
    "message_ids": ["001", "002", "003"],
    "participants": ["张三", "李四", "王五"],
    "initiator": "张三",
    "start_time": 1706140800,
    "end_time": 1706141100,
    "message_count": 3,
    "conclusion": "张三提议周末聚会，李四同意，王五建议去公园",
    "messages": [
      {
        "msg_id": "001",
        "sender_name": "张三",
        "content": "周末大家有空吗？一起聚聚",
        "timestamp": 1706140800,
        "msg_type": "1"
      },
      {
        "msg_id": "002",
        "sender_name": "李四",
        "content": "好啊，去哪里？",
        "timestamp": 1706140830,
        "msg_type": "1"
      },
      {
        "msg_id": "003",
        "sender_name": "王五",
        "content": "去公园怎么样？天气不错",
        "timestamp": 1706141100,
        "msg_type": "1"
      }
    ]
  }
]
```

---

## 功能亮点

### 1. 彩色头像

每个用户自动生成唯一的渐变色头像，基于用户名计算。

### 2. 响应式设计

支持桌面、平板、手机等各种设备。

### 3. 键盘快捷键

- `ESC` - 关闭模态框

### 4. 时间格式化

自动转换为友好的格式：

```
1706140800 → 1月15日 14:30
```

### 5. 实时搜索

输入时即时过滤，无需按回车。

---

## 浏览器兼容性

- ✅ Chrome 90+
- ✅ Firefox 88+
- ✅ Safari 14+
- ✅ Edge 90+

---

## 常见问题

### Q: 为什么导入后没有显示？
**A**: 检查 `topics.json` 格式是否正确，确保文件不为空。

### Q: 可以同时查看多个话题吗？
**A**: 每次只能查看一个话题，但可以快速切换。

### Q: 搜索不工作？
**A**: 确保已经成功导入数据，搜索框才会显示。

### Q: 消息显示不完整？
**A**: 当前显示完整的消息内容，如果有问题请检查数据源。

---

## 自定义样式

如果想修改颜色主题，可以编辑 HTML 中的 CSS 变量：

```css
/* 主题色 */
--primary-color: #4CAF50;
--secondary-color: #45a049;

/* 背景色 */
--bg-color: #f5f7fa;
--card-bg: #ffffff;
```

---

## 下一步功能（可选）

- [ ] 导出单个话题为 Markdown
- [ ] 添加时间轴视图
- [ ] 支持按参与者筛选
- [ ] 添加消息统计图表
- [ ] 支持图片/文件消息预览

---

## 技术栈

- **纯 HTML/CSS/JavaScript** - 无需安装任何依赖
- **原生 DOM 操作** - 快速轻量
- **响应式设计** - CSS Grid + Flexbox
- **渐变头像** - CSS linear-gradient

---

## 文件位置

```
vx_chat_analysis/
├── viewer/
│   ├── topic_viewer.html  # 主文件
│   └── README.md          # 本说明文档
└── output/
    └── topics.json        # 生成的话题数据
```

---

## 更新日志

### v1.0 (2025-01-24)
- ✅ 初始版本
- ✅ 支持导入 JSON
- ✅ 显示话题列表
- ✅ 查看完整对话
- ✅ 搜索功能
- ✅ 统计信息
